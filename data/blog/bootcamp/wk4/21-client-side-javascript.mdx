---
title: Client-side JavaScript and jQuery
date: '2022-07-19'
tags: ['client-side', 'jQuery']
images: ['/static/images/postImages/jquery-illustration.jpg']
draft: false
summary: JavaScript is used to create dynamic content within a webpage. However, client-side JavaScript also deals with user-generated events and interacts with the DOM.
---

<TOCInline toc={props.toc} asDisclosure />

Now we focus on how JavaScript works in the browser and also begin to get comfortable with the fundamentals of Document Object Model (DOM) traversal and manipulation with jQuery.

## DOM

- The DOM is stored as a tree data structure with parent/child/sibling relationships between various parts of the page

- The DOM allows us to interact with the web page using JavaScript

```html
<html>
  <head>
    <title>My Page</title>
  </head>
  <body>
    <h1>Welcome to my page!</h1>
    <div class="content">
      <p>My Favourite Numbers</p>
      <ul id="main-list">
        <li>One</li>
        <li>Two</li>
        <li>Three</li>
      </ul>
    </div>
  </body>
</html>
```

Can be visualized as:

<div className="my-1 px-2 w-full">
  ![dom example](/static/images/individualBlogPostImages/dom-example.png)
</div>

### Useful Browser Objects

- **`window` object**
  - Represents the window that holds the DOM object
  - Each tab in a browser is a _window_ with its own `window` object
  - Contains (among other things) information about the size of the window and screen
- **`navigator` object**
  - Contains information about the browser such as browser version, browser name, and geographic location
- **`document` object**
  - Represents the DOM
  - Can be seen in the browser console by running `console.dir(document)`

```js
// you can also access navigator and document as properties inside the window object
window.navigator === navigator // true
window.document === document // true
```

### What is the `document` object?

The `document` object is the root of the HTML document. It is the top-level object in the DOM tree.

The browser reads html files from top to bottom, while creating DOM nodes. The Document Object Model is a type of tree.

This DOM tree allows you to traverse the document and manipulate the elements within it.

```js
document.children[0].children[1].children[0]
```

> But this is very tedious to type. This is why we use jQuery to access the DOM.

### What is the `document.querySelector()` method?

- will always return the first element that matches the CSS selector

Can use `querySelectorAll()` to get all elements that match the CSS selector

## DOM Events

### Adding Event Listeners

- An event is a notification that some action has occurred (eg. a button is clicked, the mouse pointer is moved, a key is pressed)
- We can attach code (usually in the form of a `callback` function) to run when a specific event occurs... we call this "_attaching an event listener_"
- you must explicitly add an event listener to an element
- once an event listener is added, it will be called when the event occurs

```js
// we can use anonymous functions...
document.querySelector('button').addEventListener('click', (event) => {
  // do something
})

// or named functions
const eventHandler = function (event) {
  // do something
}
document.querySelector('button').addEventListener('click', eventHandler)
```

Consider the following code:

```html
<html>
  <head>
    <title>My Page</title>
  </head>
  <body>
    <div id="div-one">Click me!</div>
    <div id="div-two">No! Click Me!</div>
  </body>
</html>
```

To setup an event listener, we must...

1. add the event listener to the element
2. specify the event type to listen for
3. add a function to run when the event occurs

We use `addEventListener` to add an event listener to an element.

```js
// add an event listener to the entire body
document.addEventListener('click', () => {
  console.log('You just clicked somewhere on this page.')
})
```

What if we wanted to add an event listener to a specific element? Such as the `div-one` element?

```js
// specify the DOM node to reference using the document.getElementById method and put that reference in a variable
const div1 = document.getElementById('div-one')

// when div1 is clicked, run the function
div1.addEventListener('click', () => {
  console.log('You clicked on div 1.')
})
```

> The event will fire only when you click on `div-one`.

You can do the same thing but with an **anonymous** function:

```js
// create a function
const printMessage = () => {
  console.log('You clicked on div 2.')
}

// put a reference to the "div-two" element in a variable
const div2 = document.getElementById('div-two')

// when div2 is clicked, run the function
div2.addEventListener('click', printMessage)
```

> the function `printMessage` will be called when you click on `div-two`

Basic Syntax for Adding Event Listeners

```js
const element = document.getElementById('element')

function callback() {
  alert('Hello')
}

// Add listener
element.addEventListener('click', callback)
```

### Removing Event Listeners

Removing event listeners once they are no longer needed is a best practice (especially in long-running Web applications). To do this, use the `element.removeEventListener()` method:

```js

element.removeEventListener(<event-name>, <callback>);
```

> You must have a **reference** to the callback function that was originally bound. Simply calling `element.removeEventListener(‘click’)`; will **not work**.

```js
const element = document.getElementById('element')

function callback() {
  alert('Hello once')
  element.removeEventListener('click', callback) // remove the event listener
}

// Add listener
element.addEventListener('click', callback)
```

### Maintaining Context in Event Listeners

It is possible to lose the context of the element that was clicked on when the event listener is called.

For example, even though the function has a variable named `firstName`, the value of `firstName` will be `undefined` when the function is called.

```js
const element = document.getElementById('element')

const user = {
  firstName: 'Curtis',
  greeting: function () {
    alert('My name is ' + this.firstName)
  },
}

// Attach user.greeting as a callback
element.addEventListener('click', user.greeting)

// alert => 'My name is undefined'
```

`this` in the case above is referring to the **element** that was clicked on. Not the `user` object.

We can prevent the loss of context by doing one of two things:

1. use an **anonymous function** to maintain the context of the element that was clicked on.

```js
const element = document.getElementById('element')

const user = {
  firstName: 'Curtis',
  greeting: function () {
    // anonymous function
    alert('My name is ' + this.firstName)
  },
}

// Call the method with the correct
// context inside an anonymous function
element.addEventListener('click', function () {
  user.greeting()
})
```

2. use the `bind` method to maintain the context of the element that was clicked on.

```js
const element = document.getElementById('element')

const user = {
  firstName: 'Curtis',
  greeting: function () {
    alert('My name is ' + this.firstName)
  },
}

// Overwrite the original function with a new function with its execution context 'bound' to the user object
user.greeting = user.greeting.bind(user)

// Add the bound function as the callback
element.addEventListener('click', user.greeting)
```

## Prevent The Browser’s Default Behavior

The browsers have a default behavior will respond when certain events.

The most common event is a link being _clicked_. When a `click` event occurs on an `<a>` element, it will bubble up to the document level of the DOM, and the browser will interpret the `href` attribute and **reload the window at the new address**.

We may not want the page to be refreshed! We can prevent the browser from doing this by using the `preventDefault` method.

```js
anchor.addEventListener('click', function (event) {
  event.preventDefault()
  // Do our own thing
})
```

## Useful Events

MDN list of events: [MDN](https://developer.mozilla.org/en-US/docs/Web/Events)

### Load Events

When a page is loaded, the browser will fire a `load` event.

```js
window.addEventListener('load', function () {
  console.log('Page loaded!')
})
```

### onbeforeunload

Enables you to ask the user if they want to leave the page.

```js
window.addEventListener('beforeunload', function () {
  return 'Are you sure you want to leave?'
})
```

## jQuery

- A JavaScript library that provides a simple API for DOM manipulation, event handling, and AJAX requests
- Can be referenced with `jQuery` or the `$`
- Typically brought into a project using a **C**ontent **D**elivery **N**etwork or **CDN**
- **CDN**s store code and other files that can be brought into our projects as the browser loads our page

### jQuery Setup

- can use a [CDN to load the library ](https://cdnjs.com/libraries/jquery)
- can use the [local version of jQuery](https://jquery.com/download/)
- can install the [jQuery](https://www.npmjs.com/package/jquery) package `npm install jquery`

```html
<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
```

### Basics of jQuery

- Uses CSS selectors for finding elements in the DOM

```js
// html element
$('h1')
// class
$('.my-class')
// id
$('#my-id')
// nested element
$('.my-class span')
```

```js
$('css target').method()
```

- `$` is a shortcut for `jQuery`
- `()` css target you want
- `.method()` is the action that you want to do
  - if the params are not provided, it will return the value of the method (reads it)
  - if it is provided, it will set the value of the method (writes it)

```js
const cssValue = $('header').css('background-color')
console.log(cssValue) // 'rgb(255, 255, 255)'

// update text
$('header').text('New Text')

// update background color
$('header').css('background-color', 'rgb(255, 0, 0)')
```

### Creating Elements with jQuery

- We can use the same jQuery interface to create DOM elements by passing in the opening tag of an HTML element

```js
const newDiv = $('<div>')
const newImg = $('<img>')

// note the greater than and less than
$('img') !== $('<img>')
```

We can use jquery for eventListeners

```js
$('#element').on('click', function () {
  console.log('You clicked on the element!')
})
```

Instead of using the `addEventListener` method, we can use the `on` method.

### Targeting Elements

```js
$('button').click((event) => {
  $(event.target).css('background-color', 'rgb(255, 0, 0)')
})
```

### Event Handling with jQuery

- We can also easily attach event listeners to DOM events using jQuery

```js
// using the .on method
$('button').on('click', clickHandler)

// there are several shorthand methods for common DOM events
$('button').click(clickHandler)
$('form').submit(submitHandler)
$('input').focus(focusHandler)
```

### Document Ready

- We usually want to wait for the document to finish being loaded before our JavaScript runs
- jQuery gives us a simple interface for wrapping our code
- Once the document has finished loading, our callback is called

```js
$(document).ready(() => {
  // this callback runs once the document is "ready"
  console.log('ready')
})

// or
$(() => {
  // passing a callback to jQuery is a shorthand for $(document).ready()
  console.log('ready')
})
```

### Useful Links

- [MDN: The DOM](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction)
- [W3C DOM Standard](https://www.w3.org/DOM/)
- [MDN: Browser Events](https://developer.mozilla.org/en-US/docs/Web/Events)
- [What is the `$` in DevTools?](https://thewebivore.com/exactly-wth-is-up-with-in-devtools/)
- [jQuery Docs](https://jquery.com/)
